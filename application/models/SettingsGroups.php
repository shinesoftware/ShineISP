<?php

/**
 * SettingsGroups
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 * @package    ##PACKAGE##
 * @subpackage ##SUBPACKAGE##
 * @author     ##NAME## <##EMAIL##>
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class SettingsGroups extends BaseSettingsGroups
{
    /**
     * getList
     * Get a list ready for the html select object
     * @return array
     */
    public static function getList() {
        $items = array ();
        
        $dq = Doctrine_Query::create ()->from ( 'SettingsGroups sg' );
                                      
        $records = $dq->execute ( array (), Doctrine_Core::HYDRATE_ARRAY );
        foreach ( $records as $record ) {
            $items [$record ['group_id']] = $record ['name'];
        }
        
        return $items;
    }
    
    /**
     * find
     * Get a group information
     * @return array
     */
    public static function find($id) {
        $records = Doctrine_Query::create ()->from ( 'SettingsGroups sg' )->where('group_id = ?', $id)->limit(1)->execute ( array (), Doctrine_Core::HYDRATE_ARRAY );
        if(!empty($records[0])){
        	return $records[0];
        }
        return array();
    }
    
    /**
     * find
     * Get a group information
     * @return Doctrine
     */
    public static function findbyName($name) {
        return Doctrine_Query::create ()->from ( 'SettingsGroups sg' )->where('name = ?', $name)->limit(1)->fetchOne();
    }
    
    /**
     * 
     * Create or return the group id
     * @param string $name
     */
    public static function addGroup($name, $description=null, $help=null) {
    	
    	$g = self::findbyName($name);
    	if(!empty($g)){
    		return $g->get('group_id');
    	}
    	
    	$group = new SettingsGroups();
    	$group['name'] = $name;
    	$group['help'] = $help;
    	$group['description'] = $description;
    	$group->save();
    	
    	return $group['group_id'];
    }
}